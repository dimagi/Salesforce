<apex:page controller="BillingRateController" docType="html-5.0" action="{!initManageRate}">
    <style type="text/css">
        .brTable {
            margin-top: 10px;
            margin-bottom: 10px;
        }
        .brTable tr {
            cursor: pointer;
        }
        .brTable tr:hover td {
            background-color: #1797C0 !important;
        }
        .brTable table {
            width: auto !important;
        }
        .bText table {
            margin-top: 10px;
            margin-bottom: 10px;
            width: auto !important;
        }
        h3 {
            margin-top: 10px;
            margin-bottom: 10px;
            color: black;
        }
    </style>

    <script type="text/javascript">
        function setFocusOnLoad() {}
    </script>

    <apex:pageBlock title="Billing Rates Manager : {!billingRateName}" id="brManagerHistory">
        <apex:form >
            <apex:actionFunction action="{!setViewData}" name="setViewData" oncomplete="goToRateUpdateView();">
                <apex:param name="billingRateId" assignTo="{!billingRateId}" value=""/>
            </apex:actionFunction>
            <apex:actionFunction action="{!goToRateListView}" name="goToRateListView" />
            <apex:actionFunction action="{!goToRateUpdateView}" name="goToRateUpdateView" />

            <apex:pageBlockTable id="billingRatesId" value="{!rateHistoryList}" var="rate" styleClass="brTable">
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Effective Date" value="{!rate.Date__c}" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Overhead" value="{!rate.Overhead__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Overhead" value="{!rate.Overhead__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="G & A" value="{!rate.G_A__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Fringe" value="{!rate.Fringe__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Fee" value="{!rate.Fee__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Custom 1" value="{!rate.Custom_1__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Custom 2" value="{!rate.Custom_2__c} %" />
                <apex:column onclick="setViewData('{!rate.Id}');" headerValue="Custom 3" value="{!rate.Custom_3__c} %" />
            </apex:pageBlockTable>

            <apex:outputPanel layout="block" id="messages">
                <apex:pageMessages />
            </apex:outputPanel>
            <apex:pageBlockSection >
                <apex:commandButton disabled="{!!requiredRefresh}" action="{!runRecalculationBatchJob}" value="Recalculate rates in time cards" id="recButton" reRender="billingRatesId, messages, rateForm, recButton"/>
            </apex:pageBlockSection>
            <apex:outputPanel styleClass="bText" id="rateForm">
                <apex:pageBlockSection title="New Rate Numnbers" columns="2" collapsible="false">
                    <apex:inputField value="{!newBillingRate.Date__c}"/>
                    <apex:inputField value="{!newBillingRate.Overhead__c}"/>
                    <apex:inputField value="{!newBillingRate.Fringe__c}" />
                    <apex:inputField value="{!newBillingRate.Fee__c}"/>
                    <apex:inputField value="{!newBillingRate.G_A__c}" />
                    <apex:inputField value="{!newBillingRate.Custom_1__c}" />
                    <apex:inputField value="{!newBillingRate.Custom_2__c}" />
                    <apex:inputField value="{!newBillingRate.Custom_3__c}" />
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:commandButton action="{!saveNewRateHistory}" value="Save New Rate Numbers" id="brSaveButton" reRender="billingRatesId, messages, rateForm, recButton"/>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:commandButton action="{!goToRateListView}" value="Billign Rates List" id="backPButton" />
                </apex:pageBlockSection>
            </apex:outputPanel>
        </apex:form>
    </apex:pageBlock>
</apex:page>